
# Standardize and Enable logging in containers and cloud watch for services and lambadas.
### Summary
**As an** Engineer, **I want** to standardize and enable logging for containers and AWS Lambda functions in CloudWatch, **So That** we can centralize log management, improve monitoring, and enhance the ability to diagnose and troubleshoot issues across services.

This story aims to establish a consistent logging framework for all containerized services and AWS Lambda functions. By enabling and standardizing logging in CloudWatch, we will facilitate centralized monitoring, improve traceability, and enhance the system's observability.

### Vision
Standardizing and enabling logging in CloudWatch will provide a unified approach to collecting, storing, and analyzing logs from various services and Lambda functions. This centralized logging will enable quicker identification of issues, facilitate troubleshooting, and provide valuable insights into system behavior. It will also ensure that all logs are accessible and follow a consistent format, improving the effectiveness of our monitoring and alerting systems.

### Background
Currently, logging practices vary across containerized services and Lambda functions, resulting in fragmented and inconsistent log data. This inconsistency makes it difficult to monitor and diagnose issues effectively, leading to longer resolution times and reduced system reliability. Standardizing logging practices and centralizing logs in CloudWatch will provide a more coherent approach to log management and enhance system observability.

### Purpose
The purpose of this story is to ensure that all logs from containerized services and AWS Lambda functions are consistently formatted and centrally available in CloudWatch. This will facilitate better monitoring, quicker diagnosis of issues, and improved system performance analysis. This initiative supports the broader goal of achieving operational excellence and ensuring high system reliability.

## Details
1. **Logging Standardization**:
    - Define a standardized logging format (e.g., JSON) for all logs generated by containerized services and AWS Lambda functions, including structured fields such as timestamp, log level, service name, and request ID.
    - Implement log rotation and retention policies to manage the volume of logs stored in CloudWatch.

2. **Containerized Services Logging**:
    - Configure logging drivers (e.g., awslogs) for containerized services to send logs directly to CloudWatch.
    - Update service configurations to include the standardized logging format and ensure all logs are directed to the correct CloudWatch log groups.

3. **AWS Lambda Logging**:
    - Modify AWS Lambda functions to use the standardized logging format, ensuring all logs are captured using the `console.log` or similar logging mechanisms.
    - Ensure that Lambda function logs are automatically streamed to CloudWatch, and integrate with existing log groups.

4. **Log Group Management**:
    - Organize CloudWatch log groups based on environment (e.g., development, staging, production) and service name for easy access and filtering.
    - Set up automated log retention policies to manage the lifecycle of logs in CloudWatch.

5. **Monitoring and Alerts**:
    - Create CloudWatch metrics filters to monitor key events and errors in the logs, and set up alarms to notify relevant teams of critical issues.
    - Implement dashboards in CloudWatch to visualize log metrics and monitor the health of services and Lambda functions.

### Testing
- Validate that all containerized services and AWS Lambda functions are generating logs in the standardized format and sending them to the appropriate CloudWatch log groups.
- Test log streaming for both containerized services and Lambda functions to ensure logs are available in near real-time in CloudWatch.
- Verify that log retention policies are correctly applied to manage the volume and lifecycle of logs in CloudWatch.
- Simulate various scenarios (e.g., errors, normal operations) to confirm that logs are correctly captured, and alerts are triggered for critical events.

### External Dependencies
- Access to AWS CloudWatch for log group creation and management.
- Permissions to update containerized service configurations and AWS Lambda functions.
- Integration with existing monitoring and alerting tools in CloudWatch.

## Acceptance Criteria
- Should have a standardized logging format implemented across all containerized services and AWS Lambda functions.
- Should have logs from all services and Lambda functions directed to the appropriate CloudWatch log groups in near real-time.
- Should have log rotation and retention policies established for managing log data in CloudWatch.
- Should have CloudWatch metrics filters and alarms set up for key events and errors.
- Should have verified that all logs are accessible, correctly formatted, and integrated with monitoring dashboards in CloudWatch.

### Gherkin
#### Scenario: Standardized Logging for Containerized Services
Given the need for standardized logging,
When containerized services generate logs,
Then the logs should be formatted consistently and sent to CloudWatch log groups.

#### Scenario: Logging for AWS Lambda Functions
Given the need for centralized logging,
When AWS Lambda functions execute,
Then their logs should be sent to CloudWatch in the standardized format.

#### Scenario: Log Monitoring and Alerts
Given the logging integration with CloudWatch,
When an error or critical event is detected in the logs,
Then an alert should be triggered to notify the relevant team.

## API
N/A

## External Links
- [AWS CloudWatch Logs Documentation](https://docs.aws.amazon.com/
- [Container Logging Driver Configuration](https://docs.docker.com/config/containers/logging/configure/)
- [AWS Lambda Logging Best Practices](https://docs.aws.amazon.com/lambda/latest/dg/nodejs-logging.html)
